ARM GAS  C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s 			page 1


   1              		.cpu cortex-m4
   2              		.arch armv7e-m
   3              		.fpu fpv4-sp-d16
   4              		.eabi_attribute 27, 1
   5              		.eabi_attribute 28, 1
   6              		.eabi_attribute 20, 1
   7              		.eabi_attribute 21, 1
   8              		.eabi_attribute 23, 3
   9              		.eabi_attribute 24, 1
  10              		.eabi_attribute 25, 1
  11              		.eabi_attribute 26, 1
  12              		.eabi_attribute 30, 2
  13              		.eabi_attribute 34, 1
  14              		.eabi_attribute 18, 4
  15              		.file	"sd_card.c"
  16              		.text
  17              	.Ltext0:
  18              		.cfi_sections	.debug_frame
  19              		.file 1 "Src/sd_card.c"
  20              		.section	.rodata.error_detect.str1.4,"aMS",%progbits,1
  21              		.align	2
  22              	.LC0:
  23 0000 20526567 		.ascii	" Register file system error or create file system e"
  23      69737465 
  23      72206669 
  23      6C652073 
  23      79737465 
  24 0033 72726F72 		.ascii	"rror!\012\000"
  24      210A00
  25 003a 0000     		.align	2
  26              	.LC1:
  27 003c 453A00   		.ascii	"E:\000"
  28 003f 00       		.align	2
  29              	.LC2:
  30 0040 1B5B313B 		.ascii	"\033[1;31m\000"
  30      33316D00 
  31              		.align	2
  32              	.LC3:
  33 0048 20202573 		.ascii	"  %s%s Register file system error or create file sy"
  33      25732052 
  33      65676973 
  33      74657220 
  33      66696C65 
  34 007b 7374656D 		.ascii	"stem error!\012\015\012%s\000"
  34      20657272 
  34      6F72210A 
  34      0D0A2573 
  34      00
  35              		.align	2
  36              	.LC4:
  37 008c 1B5B306D 		.ascii	"\033[0m\000"
  37      00
  38 0091 000000   		.align	2
  39              	.LC5:
  40 0094 204F7065 		.ascii	" Open file error!\012\000"
  40      6E206669 
  40      6C652065 
ARM GAS  C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s 			page 2


  40      72726F72 
  40      210A00
  41 00a7 00       		.align	2
  42              	.LC6:
  43 00a8 20202573 		.ascii	"  %s%s Open file error!\012\015\012%s\000"
  43      2573204F 
  43      70656E20 
  43      66696C65 
  43      20657272 
  44 00c5 000000   		.align	2
  45              	.LC7:
  46 00c8 20577269 		.ascii	" Write & Read ok, welcome to Robomaster!\012\000"
  46      74652026 
  46      20526561 
  46      64206F6B 
  46      2C207765 
  47              		.section	.text.error_detect,"ax",%progbits
  48              		.align	1
  49              		.p2align 2,,3
  50              		.global	error_detect
  51              		.syntax unified
  52              		.thumb
  53              		.thumb_func
  55              	error_detect:
  56              	.LVL0:
  57              	.LFB135:
   1:Src/sd_card.c **** /**
   2:Src/sd_card.c ****  ***************************************(C) COPYRIGHT 2018 DJI*************************************
   3:Src/sd_card.c ****  * @file       sd_card.c
   4:Src/sd_card.c ****  * @brief      this file contains sd card basic operating function
   5:Src/sd_card.c ****  * @note         
   6:Src/sd_card.c ****  * @Version    V1.0.0
   7:Src/sd_card.c ****  * @Date       Jan-30-2018      
   8:Src/sd_card.c ****  ***************************************(C) COPYRIGHT 2018 DJI*************************************
   9:Src/sd_card.c ****  */
  10:Src/sd_card.c ****  
  11:Src/sd_card.c **** #include "bsp_driver_sd.h"
  12:Src/sd_card.c **** #include "stm32f4xx_hal.h"
  13:Src/sd_card.c **** #include "fatfs.h"
  14:Src/sd_card.c **** #include "sdio.h"
  15:Src/sd_card.c **** #include "sd_card.h"
  16:Src/sd_card.c **** #include "main.h"
  17:Src/sd_card.c **** #include "bsp_log.h"
  18:Src/sd_card.c **** #include "SEGGER_RTT.h"
  19:Src/sd_card.c **** #include "SEGGER_RTT_Conf.h"
  20:Src/sd_card.c **** 
  21:Src/sd_card.c **** FATFS          SDFatFs;                               /* file system object for SD card logical dri
  22:Src/sd_card.c **** static uint8_t buffer[_MAX_SS];                       /* a work buffer for the f_mkfs() */
  23:Src/sd_card.c **** uint32_t       byteswritten, bytesread;               /* file write/read counts */
  24:Src/sd_card.c **** uint8_t        rtext[100];                            /* file read buffer */
  25:Src/sd_card.c **** uint8_t        err;
  26:Src/sd_card.c **** static char    *f_name = "ares.txt";           /* file name */
  27:Src/sd_card.c **** uint8_t        wtext[] = " please come back to Hupan, Ares go! "; /* file write buffer */
  28:Src/sd_card.c **** extern UART_HandleTypeDef huart6;
  29:Src/sd_card.c **** /**
  30:Src/sd_card.c ****   * @brief  read ok indicator
  31:Src/sd_card.c ****   * @param  
ARM GAS  C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s 			page 3


  32:Src/sd_card.c ****   * @retval 
  33:Src/sd_card.c ****   */
  34:Src/sd_card.c **** static void read_ok(void)
  35:Src/sd_card.c **** {
  36:Src/sd_card.c **** 		HAL_GPIO_WritePin(LED_RED_GPIO_Port, LED_RED_Pin, GPIO_PIN_RESET);
  37:Src/sd_card.c **** }
  38:Src/sd_card.c **** 
  39:Src/sd_card.c **** /**
  40:Src/sd_card.c ****   * @brief      show errors by blinking led
  41:Src/sd_card.c ****   * @param[in]  err: error id
  42:Src/sd_card.c ****   * @retval 
  43:Src/sd_card.c ****   */
  44:Src/sd_card.c **** static void led_blinking(uint8_t num)
  45:Src/sd_card.c **** {
  46:Src/sd_card.c **** 	uint8_t i;
  47:Src/sd_card.c **** 	for (i = 0; i < num; i++)
  48:Src/sd_card.c **** 	{
  49:Src/sd_card.c **** 		HAL_GPIO_WritePin(LED_RED_GPIO_Port, LED_RED_Pin, GPIO_PIN_RESET);
  50:Src/sd_card.c **** 		HAL_Delay(4000);
  51:Src/sd_card.c **** 		HAL_GPIO_WritePin(LED_RED_GPIO_Port, LED_RED_Pin, GPIO_PIN_SET);
  52:Src/sd_card.c **** 		HAL_Delay(100);
  53:Src/sd_card.c **** 	}
  54:Src/sd_card.c **** 	HAL_Delay(500);
  55:Src/sd_card.c **** }
  56:Src/sd_card.c **** 
  57:Src/sd_card.c **** /**
  58:Src/sd_card.c ****   * @brief      show errors by blinking led
  59:Src/sd_card.c ****   * @param[in]  err: error id
  60:Src/sd_card.c ****   * @retval 
  61:Src/sd_card.c ****   */
  62:Src/sd_card.c **** void error_detect(uint8_t err)
  63:Src/sd_card.c **** {
  58              		.loc 1 63 1 view -0
  59              		.cfi_startproc
  60              		@ args = 0, pretend = 0, frame = 0
  61              		@ frame_needed = 0, uses_anonymous_args = 0
  64:Src/sd_card.c **** 		switch (err)
  62              		.loc 1 64 3 view .LVU1
  63:Src/sd_card.c **** 		switch (err)
  63              		.loc 1 63 1 is_stmt 0 view .LVU2
  64 0000 30B5     		push	{r4, r5, lr}
  65              		.cfi_def_cfa_offset 12
  66              		.cfi_offset 4, -12
  67              		.cfi_offset 5, -8
  68              		.cfi_offset 14, -4
  69              		.loc 1 64 3 view .LVU3
  70 0002 0128     		cmp	r0, #1
  63:Src/sd_card.c **** 		switch (err)
  71              		.loc 1 63 1 view .LVU4
  72 0004 83B0     		sub	sp, sp, #12
  73              		.cfi_def_cfa_offset 24
  63:Src/sd_card.c **** 		switch (err)
  74              		.loc 1 63 1 view .LVU5
  75 0006 0446     		mov	r4, r0
  76              		.loc 1 64 3 view .LVU6
  77 0008 3DD0     		beq	.L2
  78 000a 0228     		cmp	r0, #2
ARM GAS  C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s 			page 4


  79 000c 0BD0     		beq	.L11
  65:Src/sd_card.c **** 		{
  66:Src/sd_card.c **** 			case ERR_MOUNT_MKFS:
  67:Src/sd_card.c **** 			{
  68:Src/sd_card.c **** 				led_blinking(ERR_MOUNT_MKFS);
  69:Src/sd_card.c **** 				HAL_UART_Transmit(&huart6, (uint8_t *)" Register file system error or create file system error!
  70:Src/sd_card.c **** 				                 (COUNTOF(" Register file system error or create file system error!\n") - 1), 5
  71:Src/sd_card.c **** 				LOGERROR(" Register file system error or create file system error!\n");
  72:Src/sd_card.c **** 				HAL_Delay(10);	
  73:Src/sd_card.c **** 			}break;
  74:Src/sd_card.c **** 
  75:Src/sd_card.c **** 			case ERR_OPEN:
  76:Src/sd_card.c **** 			{
  77:Src/sd_card.c **** 				led_blinking(ERR_OPEN);
  78:Src/sd_card.c **** 				HAL_UART_Transmit(&huart6, (uint8_t *)" Open file error!\n", (COUNTOF(" Open file error!\n") - 
  79:Src/sd_card.c **** 				LOGERROR(" Open file error!\n");
  80:Src/sd_card.c **** 				HAL_Delay(10);	
  81:Src/sd_card.c **** 			}break;
  82:Src/sd_card.c **** 			
  83:Src/sd_card.c **** 			default:
  84:Src/sd_card.c **** 			{
  85:Src/sd_card.c **** 				HAL_UART_Transmit(&huart6, (uint8_t *)" Write & Read ok, welcome to Robomaster!\n", \
  80              		.loc 1 85 5 is_stmt 1 view .LVU7
  81 000e 3349     		ldr	r1, .L12
  82 0010 3348     		ldr	r0, .L12+4
  83              	.LVL1:
  84              		.loc 1 85 5 is_stmt 0 view .LVU8
  85 0012 3723     		movs	r3, #55
  86 0014 2922     		movs	r2, #41
  87 0016 FFF7FEFF 		bl	HAL_UART_Transmit
  88              	.LVL2:
  86:Src/sd_card.c **** 				                 (COUNTOF(" Write & Read ok, welcome to Robomaster!\n") - 1), 55);
  87:Src/sd_card.c **** 				HAL_Delay(10);	
  89              		.loc 1 87 5 is_stmt 1 view .LVU9
  90 001a 0A20     		movs	r0, #10
  88:Src/sd_card.c **** 			}break;
  89:Src/sd_card.c **** 		}
  90:Src/sd_card.c **** }
  91              		.loc 1 90 1 is_stmt 0 view .LVU10
  92 001c 03B0     		add	sp, sp, #12
  93              		.cfi_remember_state
  94              		.cfi_def_cfa_offset 12
  95              		@ sp needed
  96 001e BDE83040 		pop	{r4, r5, lr}
  97              		.cfi_restore 14
  98              		.cfi_restore 5
  99              		.cfi_restore 4
 100              		.cfi_def_cfa_offset 0
  87:Src/sd_card.c **** 			}break;
 101              		.loc 1 87 5 view .LVU11
 102 0022 FFF7FEBF 		b	HAL_Delay
 103              	.LVL3:
 104              	.L11:
 105              		.cfi_restore_state
 106              	.LBB8:
 107              	.LBB9:
  49:Src/sd_card.c **** 		HAL_Delay(4000);
ARM GAS  C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s 			page 5


 108              		.loc 1 49 3 view .LVU12
 109 0026 2F4D     		ldr	r5, .L12+8
 110 0028 00E0     		b	.L3
 111              	.LVL4:
 112              	.L5:
  49:Src/sd_card.c **** 		HAL_Delay(4000);
 113              		.loc 1 49 3 view .LVU13
 114 002a 0124     		movs	r4, #1
 115              	.L3:
  49:Src/sd_card.c **** 		HAL_Delay(4000);
 116              		.loc 1 49 3 is_stmt 1 view .LVU14
 117 002c 0022     		movs	r2, #0
 118 002e 4FF40061 		mov	r1, #2048
 119 0032 2846     		mov	r0, r5
 120 0034 FFF7FEFF 		bl	HAL_GPIO_WritePin
 121              	.LVL5:
  50:Src/sd_card.c **** 		HAL_GPIO_WritePin(LED_RED_GPIO_Port, LED_RED_Pin, GPIO_PIN_SET);
 122              		.loc 1 50 3 view .LVU15
 123 0038 4FF47A60 		mov	r0, #4000
 124 003c FFF7FEFF 		bl	HAL_Delay
 125              	.LVL6:
  51:Src/sd_card.c **** 		HAL_Delay(100);
 126              		.loc 1 51 3 view .LVU16
 127 0040 2846     		mov	r0, r5
 128 0042 0122     		movs	r2, #1
 129 0044 4FF40061 		mov	r1, #2048
 130 0048 FFF7FEFF 		bl	HAL_GPIO_WritePin
 131              	.LVL7:
  52:Src/sd_card.c **** 	}
 132              		.loc 1 52 3 view .LVU17
 133 004c 6420     		movs	r0, #100
 134 004e FFF7FEFF 		bl	HAL_Delay
 135              	.LVL8:
  47:Src/sd_card.c **** 	{
 136              		.loc 1 47 24 view .LVU18
  47:Src/sd_card.c **** 	{
 137              		.loc 1 47 16 view .LVU19
 138 0052 012C     		cmp	r4, #1
 139 0054 E9D1     		bne	.L5
  54:Src/sd_card.c **** }
 140              		.loc 1 54 2 view .LVU20
 141 0056 4FF4FA70 		mov	r0, #500
 142 005a FFF7FEFF 		bl	HAL_Delay
 143              	.LVL9:
 144              	.LBE9:
 145              	.LBE8:
  78:Src/sd_card.c **** 				LOGERROR(" Open file error!\n");
 146              		.loc 1 78 5 view .LVU21
 147 005e 2249     		ldr	r1, .L12+12
 148 0060 1F48     		ldr	r0, .L12+4
 149 0062 3723     		movs	r3, #55
 150 0064 1222     		movs	r2, #18
 151 0066 FFF7FEFF 		bl	HAL_UART_Transmit
 152              	.LVL10:
  79:Src/sd_card.c **** 				HAL_Delay(10);	
 153              		.loc 1 79 5 view .LVU22
 154 006a 2048     		ldr	r0, .L12+16
ARM GAS  C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s 			page 6


 155 006c 0090     		str	r0, [sp]
 156 006e 204B     		ldr	r3, .L12+20
 157 0070 204A     		ldr	r2, .L12+24
 158 0072 2149     		ldr	r1, .L12+28
 159 0074 0020     		movs	r0, #0
 160 0076 FFF7FEFF 		bl	SEGGER_RTT_printf
 161              	.LVL11:
  80:Src/sd_card.c **** 			}break;
 162              		.loc 1 80 5 view .LVU23
  87:Src/sd_card.c **** 			}break;
 163              		.loc 1 87 5 view .LVU24
 164 007a 0A20     		movs	r0, #10
 165              		.loc 1 90 1 is_stmt 0 view .LVU25
 166 007c 03B0     		add	sp, sp, #12
 167              		.cfi_remember_state
 168              		.cfi_def_cfa_offset 12
 169              		@ sp needed
 170 007e BDE83040 		pop	{r4, r5, lr}
 171              		.cfi_restore 14
 172              		.cfi_restore 5
 173              		.cfi_restore 4
 174              		.cfi_def_cfa_offset 0
  87:Src/sd_card.c **** 			}break;
 175              		.loc 1 87 5 view .LVU26
 176 0082 FFF7FEBF 		b	HAL_Delay
 177              	.LVL12:
 178              	.L2:
 179              		.cfi_restore_state
 180              	.LBB10:
 181              	.LBB11:
  47:Src/sd_card.c **** 	{
 182              		.loc 1 47 16 is_stmt 1 view .LVU27
  49:Src/sd_card.c **** 		HAL_Delay(4000);
 183              		.loc 1 49 3 view .LVU28
 184 0086 4FF40061 		mov	r1, #2048
 185 008a 0022     		movs	r2, #0
 186 008c 1548     		ldr	r0, .L12+8
 187              	.LVL13:
  49:Src/sd_card.c **** 		HAL_Delay(4000);
 188              		.loc 1 49 3 is_stmt 0 view .LVU29
 189 008e FFF7FEFF 		bl	HAL_GPIO_WritePin
 190              	.LVL14:
  50:Src/sd_card.c **** 		HAL_GPIO_WritePin(LED_RED_GPIO_Port, LED_RED_Pin, GPIO_PIN_SET);
 191              		.loc 1 50 3 is_stmt 1 view .LVU30
 192 0092 4FF47A60 		mov	r0, #4000
 193 0096 FFF7FEFF 		bl	HAL_Delay
 194              	.LVL15:
  51:Src/sd_card.c **** 		HAL_Delay(100);
 195              		.loc 1 51 3 view .LVU31
 196 009a 2246     		mov	r2, r4
 197 009c 4FF40061 		mov	r1, #2048
 198 00a0 1048     		ldr	r0, .L12+8
 199 00a2 FFF7FEFF 		bl	HAL_GPIO_WritePin
 200              	.LVL16:
  52:Src/sd_card.c **** 	}
 201              		.loc 1 52 3 view .LVU32
 202 00a6 6420     		movs	r0, #100
ARM GAS  C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s 			page 7


 203 00a8 FFF7FEFF 		bl	HAL_Delay
 204              	.LVL17:
  47:Src/sd_card.c **** 	{
 205              		.loc 1 47 24 view .LVU33
  47:Src/sd_card.c **** 	{
 206              		.loc 1 47 16 view .LVU34
  54:Src/sd_card.c **** }
 207              		.loc 1 54 2 view .LVU35
 208 00ac 4FF4FA70 		mov	r0, #500
 209 00b0 FFF7FEFF 		bl	HAL_Delay
 210              	.LVL18:
  54:Src/sd_card.c **** }
 211              		.loc 1 54 2 is_stmt 0 view .LVU36
 212              	.LBE11:
 213              	.LBE10:
  69:Src/sd_card.c **** 				                 (COUNTOF(" Register file system error or create file system error!\n") - 1), 5
 214              		.loc 1 69 5 is_stmt 1 view .LVU37
 215 00b4 1149     		ldr	r1, .L12+32
 216 00b6 0A48     		ldr	r0, .L12+4
 217 00b8 3723     		movs	r3, #55
 218 00ba 3922     		movs	r2, #57
 219 00bc FFF7FEFF 		bl	HAL_UART_Transmit
 220              	.LVL19:
  71:Src/sd_card.c **** 				HAL_Delay(10);	
 221              		.loc 1 71 5 view .LVU38
 222 00c0 0A48     		ldr	r0, .L12+16
 223 00c2 0090     		str	r0, [sp]
 224 00c4 0A4B     		ldr	r3, .L12+20
 225 00c6 0B4A     		ldr	r2, .L12+24
 226 00c8 0D49     		ldr	r1, .L12+36
 227 00ca 0020     		movs	r0, #0
 228 00cc FFF7FEFF 		bl	SEGGER_RTT_printf
 229              	.LVL20:
  72:Src/sd_card.c **** 			}break;
 230              		.loc 1 72 5 view .LVU39
  87:Src/sd_card.c **** 			}break;
 231              		.loc 1 87 5 view .LVU40
 232 00d0 0A20     		movs	r0, #10
 233              		.loc 1 90 1 is_stmt 0 view .LVU41
 234 00d2 03B0     		add	sp, sp, #12
 235              		.cfi_def_cfa_offset 12
 236              		@ sp needed
 237 00d4 BDE83040 		pop	{r4, r5, lr}
 238              		.cfi_restore 14
 239              		.cfi_restore 5
 240              		.cfi_restore 4
 241              		.cfi_def_cfa_offset 0
  87:Src/sd_card.c **** 			}break;
 242              		.loc 1 87 5 view .LVU42
 243 00d8 FFF7FEBF 		b	HAL_Delay
 244              	.LVL21:
 245              	.L13:
 246              		.align	2
 247              	.L12:
 248 00dc C8000000 		.word	.LC7
 249 00e0 00000000 		.word	huart6
 250 00e4 00100240 		.word	1073876992
ARM GAS  C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s 			page 8


 251 00e8 94000000 		.word	.LC5
 252 00ec 8C000000 		.word	.LC4
 253 00f0 3C000000 		.word	.LC1
 254 00f4 40000000 		.word	.LC2
 255 00f8 A8000000 		.word	.LC6
 256 00fc 00000000 		.word	.LC0
 257 0100 48000000 		.word	.LC3
 258              		.cfi_endproc
 259              	.LFE135:
 261              		.section	.rodata.sd_test.str1.4,"aMS",%progbits,1
 262              		.align	2
 263              	.LC8:
 264 0000 61726573 		.ascii	"ares.txt\000"
 264      2E747874 
 264      00
 265              		.section	.text.sd_test,"ax",%progbits
 266              		.align	1
 267              		.p2align 2,,3
 268              		.global	sd_test
 269              		.syntax unified
 270              		.thumb
 271              		.thumb_func
 273              	sd_test:
 274              	.LFB136:
  91:Src/sd_card.c **** 
  92:Src/sd_card.c **** /**
  93:Src/sd_card.c ****   * @brief  doing some tests to SD card, like mount, create file, open a text etc. 
  94:Src/sd_card.c ****   * @param  
  95:Src/sd_card.c ****   * @retval 
  96:Src/sd_card.c ****   */
  97:Src/sd_card.c **** void sd_test(void)
  98:Src/sd_card.c **** {   
 275              		.loc 1 98 1 is_stmt 1 view -0
 276              		.cfi_startproc
 277              		@ args = 0, pretend = 0, frame = 0
 278              		@ frame_needed = 0, uses_anonymous_args = 0
  99:Src/sd_card.c **** 	/* Register the file system object to the FatFs module and create a FAT file system (format) on th
 100:Src/sd_card.c **** 
 101:Src/sd_card.c **** 	// uint8_t fmkfs_error = f_mkfs((TCHAR const*)SDPath, FM_ANY, 0, buffer, sizeof(buffer));
 102:Src/sd_card.c **** 	if ((f_mount(&SDFatFs, (TCHAR const*)SDPath, 0) == FR_OK) && (f_mkfs((TCHAR const*)SDPath, FM_ANY,
 279              		.loc 1 102 2 view .LVU44
  98:Src/sd_card.c **** 	/* Register the file system object to the FatFs module and create a FAT file system (format) on th
 280              		.loc 1 98 1 is_stmt 0 view .LVU45
 281 0000 10B5     		push	{r4, lr}
 282              		.cfi_def_cfa_offset 8
 283              		.cfi_offset 4, -8
 284              		.cfi_offset 14, -4
 285              		.loc 1 102 7 view .LVU46
 286 0002 2349     		ldr	r1, .L21
 287 0004 2348     		ldr	r0, .L21+4
  98:Src/sd_card.c **** 	/* Register the file system object to the FatFs module and create a FAT file system (format) on th
 288              		.loc 1 98 1 view .LVU47
 289 0006 82B0     		sub	sp, sp, #8
 290              		.cfi_def_cfa_offset 16
 291              		.loc 1 102 7 view .LVU48
 292 0008 0022     		movs	r2, #0
 293 000a FFF7FEFF 		bl	f_mount
ARM GAS  C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s 			page 9


 294              	.LVL22:
 295              		.loc 1 102 5 view .LVU49
 296 000e 40B1     		cbz	r0, .L19
 297              	.L15:
 103:Src/sd_card.c **** 	{
 104:Src/sd_card.c **** 
 105:Src/sd_card.c **** 			/* Create and Open a new text file object with write access */
 106:Src/sd_card.c **** 			if (f_open(&SDFile, f_name, FA_CREATE_ALWAYS | FA_WRITE) == FR_OK)  
 107:Src/sd_card.c **** 			{
 108:Src/sd_card.c **** 				/* Write data to the text file */
 109:Src/sd_card.c **** 				f_write(&SDFile, wtext, sizeof(wtext), (void *)&byteswritten);  
 110:Src/sd_card.c **** 				/* Close the open text file */
 111:Src/sd_card.c **** 				f_close(&SDFile); 
 112:Src/sd_card.c **** 				
 113:Src/sd_card.c **** 				/* Open the text file object with read access */
 114:Src/sd_card.c **** 				if (f_open(&SDFile, f_name, FA_READ) == FR_OK)  
 115:Src/sd_card.c **** 				{
 116:Src/sd_card.c **** 					/* Read data from the text file */
 117:Src/sd_card.c **** 					f_read(&SDFile, rtext, sizeof(rtext), (UINT*)&bytesread);  
 118:Src/sd_card.c **** 					read_ok();
 119:Src/sd_card.c **** 
 120:Src/sd_card.c **** 					/* Close the open text file */
 121:Src/sd_card.c **** 					f_close(&SDFile);  
 122:Src/sd_card.c **** 				}
 123:Src/sd_card.c **** 				else
 124:Src/sd_card.c **** 				{
 125:Src/sd_card.c **** 					err=ERR_OPEN;
 126:Src/sd_card.c **** 				}
 127:Src/sd_card.c **** 			}
 128:Src/sd_card.c **** 			else
 129:Src/sd_card.c **** 			{
 130:Src/sd_card.c **** 				err=ERR_OPEN;
 131:Src/sd_card.c **** 			}
 132:Src/sd_card.c **** 	}
 133:Src/sd_card.c **** 	else
 134:Src/sd_card.c **** 	{
 135:Src/sd_card.c **** 		err=ERR_MOUNT_MKFS;
 298              		.loc 1 135 3 is_stmt 1 view .LVU50
 299              		.loc 1 135 6 is_stmt 0 view .LVU51
 300 0010 214B     		ldr	r3, .L21+8
 301 0012 0122     		movs	r2, #1
 302 0014 1A70     		strb	r2, [r3]
 303              	.L17:
 136:Src/sd_card.c **** 	}
 137:Src/sd_card.c **** 	/* Unlink the SD disk I/O driver */
 138:Src/sd_card.c **** 	FATFS_UnLinkDriver(SDPath);
 304              		.loc 1 138 2 is_stmt 1 view .LVU52
 305 0016 1E48     		ldr	r0, .L21
 139:Src/sd_card.c **** }
 306              		.loc 1 139 1 is_stmt 0 view .LVU53
 307 0018 02B0     		add	sp, sp, #8
 308              		.cfi_remember_state
 309              		.cfi_def_cfa_offset 8
 310              		@ sp needed
 311 001a BDE81040 		pop	{r4, lr}
 312              		.cfi_restore 14
 313              		.cfi_restore 4
ARM GAS  C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s 			page 10


 314              		.cfi_def_cfa_offset 0
 138:Src/sd_card.c **** }
 315              		.loc 1 138 2 view .LVU54
 316 001e FFF7FEBF 		b	FATFS_UnLinkDriver
 317              	.LVL23:
 318              	.L19:
 319              		.cfi_restore_state
 102:Src/sd_card.c **** 	{
 320              		.loc 1 102 64 discriminator 1 view .LVU55
 321 0022 4FF40071 		mov	r1, #512
 322 0026 0246     		mov	r2, r0
 323 0028 0091     		str	r1, [sp]
 324 002a 1C4B     		ldr	r3, .L21+12
 325 002c 1848     		ldr	r0, .L21
 326 002e 0721     		movs	r1, #7
 327 0030 FFF7FEFF 		bl	f_mkfs
 328              	.LVL24:
 102:Src/sd_card.c **** 	{
 329              		.loc 1 102 60 discriminator 1 view .LVU56
 330 0034 0028     		cmp	r0, #0
 331 0036 EBD1     		bne	.L15
 106:Src/sd_card.c **** 			{
 332              		.loc 1 106 4 is_stmt 1 view .LVU57
 106:Src/sd_card.c **** 			{
 333              		.loc 1 106 8 is_stmt 0 view .LVU58
 334 0038 1949     		ldr	r1, .L21+16
 335 003a 1A48     		ldr	r0, .L21+20
 336 003c 0A22     		movs	r2, #10
 337 003e FFF7FEFF 		bl	f_open
 338              	.LVL25:
 106:Src/sd_card.c **** 			{
 339              		.loc 1 106 7 view .LVU59
 340 0042 18B1     		cbz	r0, .L20
 341              	.L16:
 125:Src/sd_card.c **** 				}
 342              		.loc 1 125 6 is_stmt 1 view .LVU60
 125:Src/sd_card.c **** 				}
 343              		.loc 1 125 9 is_stmt 0 view .LVU61
 344 0044 144B     		ldr	r3, .L21+8
 345 0046 0222     		movs	r2, #2
 346 0048 1A70     		strb	r2, [r3]
 347 004a E4E7     		b	.L17
 348              	.L20:
 109:Src/sd_card.c **** 				/* Close the open text file */
 349              		.loc 1 109 5 is_stmt 1 view .LVU62
 350 004c 164B     		ldr	r3, .L21+24
 351 004e 1749     		ldr	r1, .L21+28
 352 0050 1448     		ldr	r0, .L21+20
 353 0052 2622     		movs	r2, #38
 354 0054 FFF7FEFF 		bl	f_write
 355              	.LVL26:
 111:Src/sd_card.c **** 				
 356              		.loc 1 111 5 view .LVU63
 357 0058 1248     		ldr	r0, .L21+20
 358 005a FFF7FEFF 		bl	f_close
 359              	.LVL27:
 114:Src/sd_card.c **** 				{
ARM GAS  C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s 			page 11


 360              		.loc 1 114 5 view .LVU64
 114:Src/sd_card.c **** 				{
 361              		.loc 1 114 9 is_stmt 0 view .LVU65
 362 005e 1049     		ldr	r1, .L21+16
 363 0060 1048     		ldr	r0, .L21+20
 364 0062 0122     		movs	r2, #1
 365 0064 FFF7FEFF 		bl	f_open
 366              	.LVL28:
 114:Src/sd_card.c **** 				{
 367              		.loc 1 114 8 view .LVU66
 368 0068 0446     		mov	r4, r0
 369 006a 0028     		cmp	r0, #0
 370 006c EAD1     		bne	.L16
 117:Src/sd_card.c **** 					read_ok();
 371              		.loc 1 117 6 is_stmt 1 view .LVU67
 372 006e 104B     		ldr	r3, .L21+32
 373 0070 1049     		ldr	r1, .L21+36
 374 0072 0C48     		ldr	r0, .L21+20
 375 0074 6422     		movs	r2, #100
 376 0076 FFF7FEFF 		bl	f_read
 377              	.LVL29:
 118:Src/sd_card.c **** 
 378              		.loc 1 118 6 view .LVU68
 379              	.LBB12:
 380              	.LBI12:
  34:Src/sd_card.c **** {
 381              		.loc 1 34 13 view .LVU69
 382              	.LBB13:
  36:Src/sd_card.c **** }
 383              		.loc 1 36 3 view .LVU70
 384 007a 0F48     		ldr	r0, .L21+40
 385 007c 2246     		mov	r2, r4
 386 007e 4FF40061 		mov	r1, #2048
 387 0082 FFF7FEFF 		bl	HAL_GPIO_WritePin
 388              	.LVL30:
 389              	.LBE13:
 390              	.LBE12:
 121:Src/sd_card.c **** 				}
 391              		.loc 1 121 6 view .LVU71
 392 0086 0748     		ldr	r0, .L21+20
 393 0088 FFF7FEFF 		bl	f_close
 394              	.LVL31:
 395 008c C3E7     		b	.L17
 396              	.L22:
 397 008e 00BF     		.align	2
 398              	.L21:
 399 0090 00000000 		.word	SDPath
 400 0094 00000000 		.word	SDFatFs
 401 0098 00000000 		.word	err
 402 009c 00000000 		.word	buffer
 403 00a0 00000000 		.word	.LC8
 404 00a4 00000000 		.word	SDFile
 405 00a8 00000000 		.word	byteswritten
 406 00ac 00000000 		.word	wtext
 407 00b0 00000000 		.word	bytesread
 408 00b4 00000000 		.word	rtext
 409 00b8 00100240 		.word	1073876992
ARM GAS  C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s 			page 12


 410              		.cfi_endproc
 411              	.LFE136:
 413              		.global	wtext
 414              		.section	.data.wtext,"aw"
 415              		.align	2
 418              	wtext:
 419 0000 20706C65 		.ascii	" please come back to Hupan, Ares go! \000"
 419      61736520 
 419      636F6D65 
 419      20626163 
 419      6B20746F 
 420              		.global	err
 421              		.section	.bss.err,"aw",%nobits
 424              	err:
 425 0000 00       		.space	1
 426              		.global	rtext
 427              		.section	.bss.rtext,"aw",%nobits
 428              		.align	2
 431              	rtext:
 432 0000 00000000 		.space	100
 432      00000000 
 432      00000000 
 432      00000000 
 432      00000000 
 433              		.global	bytesread
 434              		.section	.bss.bytesread,"aw",%nobits
 435              		.align	2
 438              	bytesread:
 439 0000 00000000 		.space	4
 440              		.global	byteswritten
 441              		.section	.bss.byteswritten,"aw",%nobits
 442              		.align	2
 445              	byteswritten:
 446 0000 00000000 		.space	4
 447              		.section	.bss.buffer,"aw",%nobits
 448              		.align	2
 451              	buffer:
 452 0000 00000000 		.space	512
 452      00000000 
 452      00000000 
 452      00000000 
 452      00000000 
 453              		.global	SDFatFs
 454              		.section	.bss.SDFatFs,"aw",%nobits
 455              		.align	2
 458              	SDFatFs:
 459 0000 00000000 		.space	564
 459      00000000 
 459      00000000 
 459      00000000 
 459      00000000 
 460              		.text
 461              	.Letext0:
 462              		.file 2 "c:\\users\\pw705\\appdata\\roaming\\code\\user\\globalstorage\\bmd.stm32-for-vscode\\@xpa
 463              		.file 3 "c:\\users\\pw705\\appdata\\roaming\\code\\user\\globalstorage\\bmd.stm32-for-vscode\\@xpa
 464              		.file 4 "Drivers/CMSIS/Device/ST/STM32F4xx/Include/stm32f427xx.h"
 465              		.file 5 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_def.h"
ARM GAS  C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s 			page 13


 466              		.file 6 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_gpio.h"
 467              		.file 7 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_dma.h"
 468              		.file 8 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal_uart.h"
 469              		.file 9 "Middlewares/Third_Party/FatFs/src/integer.h"
 470              		.file 10 "Middlewares/Third_Party/FatFs/src/ff.h"
 471              		.file 11 "Inc/fatfs.h"
 472              		.file 12 "Middlewares/Third_Party/FatFs/src/ff_gen_drv.h"
 473              		.file 13 "Drivers/STM32F4xx_HAL_Driver/Inc/stm32f4xx_hal.h"
 474              		.file 14 "Inc/bsp_log.h"
 475              		.file 15 "Inc/sd_card.h"
ARM GAS  C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s 			page 14


DEFINED SYMBOLS
                            *ABS*:00000000 sd_card.c
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:21     .rodata.error_detect.str1.4:00000000 $d
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:48     .text.error_detect:00000000 $t
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:55     .text.error_detect:00000000 error_detect
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:248    .text.error_detect:000000dc $d
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:262    .rodata.sd_test.str1.4:00000000 $d
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:266    .text.sd_test:00000000 $t
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:273    .text.sd_test:00000000 sd_test
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:399    .text.sd_test:00000090 $d
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:458    .bss.SDFatFs:00000000 SDFatFs
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:424    .bss.err:00000000 err
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:451    .bss.buffer:00000000 buffer
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:445    .bss.byteswritten:00000000 byteswritten
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:418    .data.wtext:00000000 wtext
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:438    .bss.bytesread:00000000 bytesread
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:431    .bss.rtext:00000000 rtext
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:415    .data.wtext:00000000 $d
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:425    .bss.err:00000000 $d
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:428    .bss.rtext:00000000 $d
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:435    .bss.bytesread:00000000 $d
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:442    .bss.byteswritten:00000000 $d
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:448    .bss.buffer:00000000 $d
C:\Users\pw705\AppData\Local\Temp\cc5GVG88.s:455    .bss.SDFatFs:00000000 $d

UNDEFINED SYMBOLS
HAL_UART_Transmit
HAL_Delay
HAL_GPIO_WritePin
SEGGER_RTT_printf
huart6
f_mount
FATFS_UnLinkDriver
f_mkfs
f_open
f_write
f_close
f_read
SDPath
SDFile
